name: Secret Scanning

on:
  workflow_dispatch:
    inputs:
      fail-on-detection:
        description: 'Fail workflow if secrets are detected'
        required: false
        type: boolean
        default: false

permissions:
  contents: read

jobs:
  gitleaks:
    name: ğŸ” Gitleaks Secret Detection
    uses: ./.github/workflows/reusable-gitleaks-scan.yml
    secrets:
      DEFECTDOJO_TOKEN: ${{ secrets.DEFECTDOJO_TOKEN }}
    with:
      fail-on-detection: ${{ inputs.fail-on-detection || false }}
      gitleaks-version: '8.21.2'
